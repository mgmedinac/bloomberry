{% extends "base.html" %}
{% load static i18n %}

{% block content %}
<div class="container my-4">
  <h2>Asistente BloomBerry</h2>

  <div id="chat" class="border rounded p-3" style="height:60vh; overflow-y:auto;">
    {# OJO: chat_messages, no messages #}
    {% for m in chat_messages %}
      <div class="p-2 my-2 {% if m.role == 'user' %}bg-light text-end{% else %}bg-white border{% endif %}">
        {% if m.role != 'user' %}<div class="text-muted small mb-1">Asistente</div>{% endif %}
        <div>{{ m.content|linebreaksbr }}</div>
      </div>
    {% empty %}
      <div class="text-muted">
        Â¡Hola! Soy tu asistente virtual de BloomBerry ðŸ˜Š. Puedo ayudarte con productos de cuidado facial, maquillaje,
        medicamentos naturales, esencias y suplementos diarios. Â¿QuÃ© estÃ¡s buscando hoy?
      </div>
    {% endfor %}
  </div>

  <form id="chat-form" method="post" action="{% url 'chat:send_message' %}" class="d-flex gap-2 mt-3">
    {% csrf_token %}
    <input id="msg" type="text" name="message" class="form-control" placeholder="Escribe tu dudaâ€¦">
    <button class="btn btn-primary" type="submit">Enviar</button>
  </form>
</div>
â€¦
{% endblock %}
